# Last Full Spec Suite Run

## Run Date
2025-11-10

## Execution Method
Run in segments to avoid timeouts and identify issues more efficiently. Never run `bundle exec rspec` without arguments.

## Status
✅ **Complete** - Full suite run completed

**Started**: 2025-11-10 09:27:40
**Completed**: 2025-11-10 09:40:23

## Timing Results

### Model Specs
- **Status**: ✅ Complete
- **Time**: 40.65 seconds (47.36 seconds total with load time)
- **Date/Time**: 2025-11-10 09:27:40
- **Examples**: 993
- **Failures**: 0

### Controller Specs
- **Status**: ⚠️ Complete with Failures
- **Time**: 32.24 seconds (37.86 seconds total with load time)
- **Date/Time**: 2025-11-10 09:28:50
- **Examples**: 401
- **Failures**: 3

### Request Specs
- **Status**: ⚠️ Complete with Failures
- **Time**: 24.68 seconds (29.50 seconds total with load time)
- **Date/Time**: 2025-11-10 09:29:53
- **Examples**: 159
- **Failures**: 25

### Decorator Specs
- **Status**: ✅ Complete
- **Time**: 3.98 seconds (8.65 seconds total with load time)
- **Date/Time**: 2025-11-10 09:30:31
- **Examples**: 35
- **Failures**: 0

### Policy Specs
- **Status**: ✅ Complete
- **Time**: 12.39 seconds (16.55 seconds total with load time)
- **Date/Time**: 2025-11-10 09:30:49
- **Examples**: 183
- **Failures**: 0

### Service Specs
- **Status**: ⚠️ Complete with Failures
- **Time**: 14.92 seconds (20.75 seconds total with load time)
- **Date/Time**: 2025-11-10 09:31:14
- **Examples**: 263
- **Failures**: 6

### Query Specs
- **Status**: ✅ Complete
- **Time**: 44.45 seconds (52.70 seconds total with load time)
- **Date/Time**: 2025-11-10 09:31:44
- **Examples**: 125
- **Failures**: 0

### Job Specs
- **Status**: ✅ Complete
- **Time**: 9.09 seconds (14.09 seconds total with load time)
- **Date/Time**: 2025-11-10 09:32:38
- **Examples**: 67
- **Failures**: 0

### Form Specs
- **Status**: ✅ Complete
- **Time**: 6.50 seconds (11.19 seconds total with load time)
- **Date/Time**: 2025-11-10 09:32:54
- **Examples**: 82
- **Failures**: 0

### Helper Specs
- **Status**: ✅ Complete
- **Time**: 11.75 seconds (17.50 seconds total with load time)
- **Date/Time**: 2025-11-10 09:33:07
- **Examples**: 82
- **Failures**: 0

### System Specs - Abilities
- **Status**: ✅ Complete
- **Time**: 20.17 seconds (29.08 seconds total with load time)
- **Date/Time**: 2025-11-10 09:33:37
- **Examples**: 3
- **Failures**: 0

### System Specs - Aspirations
- **Status**: ✅ Complete
- **Time**: 23.02 seconds (28.19 seconds total with load time)
- **Date/Time**: 2025-11-10 09:34:40
- **Examples**: 7
- **Failures**: 0

### System Specs - Assignments
- **Status**: ✅ Complete
- **Time**: 13.33 seconds (18.29 seconds total with load time)
- **Date/Time**: 2025-11-10 09:35:16
- **Examples**: 2
- **Failures**: 0

### System Specs - Audit
- **Status**: ✅ Complete (3 pending)
- **Time**: 0.66 seconds (5.48 seconds total with load time)
- **Date/Time**: 2025-11-10 09:35:36
- **Examples**: 3
- **Failures**: 0
- **Pending**: 3

### System Specs - Check-in Observations
- **Status**: ✅ Complete (1 pending)
- **Time**: 0.69 seconds (3.92 seconds total with load time)
- **Date/Time**: 2025-11-10 09:35:43
- **Examples**: 1
- **Failures**: 0
- **Pending**: 1

### System Specs - Check-ins
- **Status**: ✅ Complete
- **Time**: 14.99 seconds (21.31 seconds total with load time)
- **Date/Time**: 2025-11-10 09:35:59
- **Examples**: 4
- **Failures**: 0

### System Specs - Finalization
- **Status**: ✅ Complete
- **Time**: 19.59 seconds (24.22 seconds total with load time)
- **Date/Time**: 2025-11-10 09:36:22
- **Examples**: 3
- **Failures**: 0

### System Specs - Goals
- **Status**: ✅ Complete (7 pending)
- **Time**: 101.93 seconds (106.59 seconds total with load time)
- **Date/Time**: 2025-11-10 09:36:48
- **Examples**: 43
- **Failures**: 0
- **Pending**: 7

### System Specs - Huddles
- **Status**: ⚠️ Complete with Error
- **Time**: 0.00 seconds (0.60 seconds total with load time)
- **Date/Time**: 2025-11-10 09:38:54
- **Examples**: 0
- **Failures**: 0
- **Errors**: 1 (outside examples)

### System Specs - Misc
- **Status**: ✅ Complete (1 error outside examples)
- **Time**: 53.78 seconds (59.11 seconds total with load time)
- **Date/Time**: 2025-11-10 09:38:56
- **Examples**: 24
- **Failures**: 0
- **Errors**: 1 (outside examples)

### System Specs - Positions and Seats
- **Status**: ✅ Complete (3 pending)
- **Time**: 0.72 seconds (6.56 seconds total with load time)
- **Date/Time**: 2025-11-10 09:39:57
- **Examples**: 3
- **Failures**: 0
- **Pending**: 3

### System Specs - Observations
- **Status**: N/A (no specs found)
- **Time**: N/A
- **Date/Time**: N/A
- **Examples**: 0
- **Failures**: 0

### System Specs - Teammates
- **Status**: ✅ Complete (3 pending)
- **Time**: 0.79 seconds (5.88 seconds total with load time)
- **Date/Time**: 2025-11-10 09:40:15
- **Examples**: 3
- **Failures**: 0
- **Pending**: 3

### ENM Specs
- **Status**: ✅ Complete
- **Time**: 29.26 seconds (33.09 seconds total with load time)
- **Date/Time**: 2025-11-10 09:40:23
- **Examples**: 106
- **Failures**: 0

## Total Summary
- **Total Examples**: 2,333 (993 models + 401 controllers + 159 requests + 35 decorators + 183 policies + 263 services + 125 queries + 67 jobs + 82 forms + 82 helpers + 95 system + 106 ENM)
- **Total Failures**: 34 (0 models + 3 controllers + 25 requests + 0 decorators + 0 policies + 6 services + 0 queries + 0 jobs + 0 forms + 0 helpers + 0 system failures + 0 ENM)
- **Total Errors**: 2 (outside examples - huddles and misc)
- **Total Pending**: 14 (system specs)
- **Total Time**: ~13 minutes (when run in segments)
- **System Spec Examples**: 95
- **System Spec Failures**: 0

## Failure Analysis

This section contains detailed information about each failed spec from the current run. Failures are grouped by segment and then by pattern/root cause when possible.

### Controller Specs (3 failures)

1. **HuddlesController GET #direct_feedback**
   - **File**: `spec/controllers/huddles_controller_spec.rb:710`
   - **Error**: Expected redirect to `/auth/google_oauth2` but got redirect to `/`
   - **Root Cause**: Authentication redirect logic may have changed

2. **Organizations::EmployeesController GET #index**
   - **File**: `spec/controllers/organizations/employees_controller_spec.rb:43`
   - **Error**: Expected array to include specific teammate objects but got different instances (STI type mismatch - CompanyTeammate vs Teammate)
   - **Root Cause**: STI type comparison issue in test expectations

3. **Organizations::FinalizationsController POST #create**
   - **File**: `spec/controllers/organizations/finalizations_controller_spec.rb:75`
   - **Error**: Received unexpected arguments to CheckInFinalizationService.new (ActionController::Parameters vs hash_including)
   - **Root Cause**: Mock expectation too strict - actual parameters wrapped in ActionController::Parameters

### Request Specs (25 failures)

**Primary Issue**: Policy validation errors - policies require CompanyTeammate but receiving Teammate

**Affected Areas**:
- UploadEventsController (4 failures)
- EmploymentTenuresController (10 failures)
- Organizations::CheckInsController (1 failure)
- Organizations::DepartmentsAndTeamsController (3 failures)
- Identity Management (2 failures)
- UploadEventsController comprehensive error handling (5 failures)

**Root Cause**: Tests are creating Teammate instances but policies validate that they must be CompanyTeammate instances. This is a test setup issue where factories or test helpers need to create CompanyTeammate instead of Teammate.

### Service Specs (6 failures)

**Primary Issue**: MaapChangeExecutionService failures related to check-in field updates

**Affected Tests**:
- `MaapChangeExecutionService#execute! with assignment_management change type` - multiple scenarios around updating manager/employee/official check-in fields and unchecking employee completion

**Root Cause**: Likely timezone or timestamp comparison issues in check-in field updates

**Additional Failure**:
- `Goals::BulkCreateService#call with outgoing links` - creates goals as quantitative_key_result

### System Specs - Huddles (1 error outside examples)

**Status**: Error occurred during spec loading, preventing any examples from running
- **Root Cause**: Load error in huddles spec file (likely a missing require or syntax error)

### System Specs - Misc (1 error outside examples)

**Status**: All examples passed but error occurred outside examples
- **Root Cause**: Error during test suite execution but not related to specific test cases

### Notes

- All system specs passed with 0 failures (14 pending tests marked with xit)
- Policy specs now pass (0 failures) - previous issues resolved
- Main failure pattern is policy validation requiring CompanyTeammate vs Teammate in test setup

---

**Note**: This failure analysis will be automatically populated when running segments with the segmented spec running strategy. Each failure will include:
- **File Path**: Full path to the spec file
- **Line Number**: Line number of the failing test (if available)
- **Test Description**: The full description of the failing test
- **Error Message**: First line or key excerpt of the error message
- **Suspected Issue**: Analysis of the error pattern to identify the likely root cause
