- cacheable ||= local_assigns[:cacheable]
- current_teammate ||= local_assigns[:current_teammate] || current_company_teammate
- source ||= local_assigns[:source]
- return_url ||= local_assigns[:return_url] || request.fullpath

- has_identity = has_external_identity?(current_teammate, source)
- sync_path = external_project_cache_path(cacheable, source, :sync)

.alert.alert-info
  %strong Ready to Sync
  %p.mb-2
    This #{source_display_name(source)} project is ready to be synced.
    %br
    Click the button below to fetch and cache the latest project data.
  - if has_identity
    %p.mb-0
      = form_with url: sync_path, method: :post, local: true, class: "d-inline" do |f|
        = hidden_field_tag :source, source
        = f.submit "Sync Project", class: "btn btn-primary"
  - else
    %p.mb-0
      = button_tag "Sync Project", type: "button", class: "btn btn-primary", disabled: true, data: { bs_toggle: "tooltip", bs_placement: "top", bs_title: "Connect your #{source_display_name(source)} account to sync" } do
        %i.bi.bi-exclamation-triangle.me-2
        Sync Project

