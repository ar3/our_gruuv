-# Aspiration Check-Ins Table View with Interactive Forms
- if aspiration_check_ins&.any?
  .table-responsive
    %table.table.table-striped
      %thead
        %tr
          %th Aspiration
          %th{style: "display: none;"} ID
          - if view_mode == :employee
            %th Employee Rating
            %th Employee Notes
            %th Manager Status
            %th Status
          - elsif view_mode == :manager
            %th Manager Rating
            %th Manager Notes
            %th Employee Status
            %th Status
          - else
            %th Employee Rating
            %th Employee Notes
            %th Manager Rating
            %th Manager Notes
            %th Status
      %tbody
        - aspiration_check_ins.each do |check_in|
          -# Determine which partial to render based on CheckInBehavior methods
          - display_mode = check_in.viewer_display_mode(view_mode)
          - partial_name = "aspiration_check_ins_table_#{view_mode}_#{display_mode}"
          
          = form.fields_for :aspiration_check_ins, check_in, index: check_in.id do |af|
            %tr{data: {check_in_id: check_in.id}}
              %td
                = form.submit check_in.aspiration.name,
                              class: "btn btn-link text-decoration-none p-0 border-0 bg-transparent text-start",
                              name: "save_and_view_aspiration_#{check_in.aspiration.id}",
                              "data-bs-toggle" => "popover",
                              "data-bs-trigger" => "hover",
                              "data-bs-placement" => "right",
                              "data-bs-html" => "true",
                              "data-bs-content" => latest_aspiration_check_in_popover_content(check_in.teammate, check_in.aspiration)
                %i.bi.bi-clock-history.ms-1.text-muted
              = render partial_name, check_in: check_in, form: af, main_form: form, view_mode: view_mode
- else
  .alert.alert-info
    %i.bi.bi-info-circle.me-2
    No aspirations available to do a check-in on
    .mt-2
      = link_to organization_aspirations_path(@organization), class: "btn btn-outline-primary btn-sm" do
        %i.bi.bi-plus-circle.me-1
        Manage Aspirations