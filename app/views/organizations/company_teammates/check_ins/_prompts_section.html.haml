= render 'shared/section_header', 
         title: "#{company_label_plural('prompt', 'Prompt')} / #{company_label_plural('reflection', 'Reflection')}", 
         icon: 'bi-file-text', 
         description: "Recent #{company_label_for('reflection', 'reflection').downcase} #{company_label_for('prompt', 'prompt').pluralize}",
         collapsible: true,
         collapse_target: 'promptsSection'

-# Summary view (shown when collapsed)
.card.mb-4.collapse-summary
  .card-body
    %p.mb-0
      - if @open_prompts_count > 0
        %strong= pluralize(@open_prompts_count, "open #{company_label_for('prompt', 'prompt').downcase}")
        available
      - else
        No open #{company_label_for('prompt', 'prompt').pluralize} available.

-# Collapsible content
.collapse#promptsSection
  .card.mb-4
    .card-body
      - if @open_prompts_count > 0
        %p.mb-3
          %strong= pluralize(@open_prompts_count, "open #{company_label_for('prompt', 'prompt').downcase}")
          available
      
      - if @recent_prompts.any?
        .list-group.mb-3
          - @recent_prompts.each do |prompt|
            .list-group-item
              .d-flex.justify-content-between.align-items-start
                .flex-grow-1
                  %h6.mb-1
                    = prompt.prompt_template.title
                    - if prompt.open?
                      %span.badge.bg-warning.text-dark.ms-2 Open
                    - else
                      %span.badge.bg-secondary.ms-2 Closed
                  %p.mb-1.text-muted
                    = format_date_in_user_timezone(prompt.created_at)
                  - if prompt.prompt_answers.any?
                    %small.text-muted
                      = pluralize(prompt.prompt_answers.count, 'answer')
                - if policy(prompt).show?
                  = link_to edit_organization_prompt_path(@organization, prompt), 
                            class: "btn btn-sm btn-outline-primary ms-2",
                            target: "_blank" do
                    %i.bi.bi-eye.me-1
                    View
      - else
        %p.text-muted.mb-3 No recent #{company_label_for('prompt', 'prompt').pluralize} to display.
      
      .d-grid
        = button_to "View All #{company_label_plural('prompt', 'Prompt')}", 
                    save_and_redirect_organization_company_teammate_check_ins_path(organization, @teammate), 
                    method: :post,
                    params: { redirect_url: @prompts_url },
                    class: "btn btn-outline-primary"

