-# Position Finalization Row - Ready to Finalize
%tr
  %td
    %strong= check_in.employment_tenure.position.display_name
    = link_to organization_teammate_position_path(organization, teammate), target: '_blank', rel: 'noopener noreferrer', class: 'ms-2', title: 'View position' do
      %i.bi.bi-box-arrow-up-right
  %td
    %div
      = position_rating_display(check_in.employee_rating)
    .finalization-notes-cell
      %small.text-muted= simple_format(check_in.employee_private_notes)
  %td
    %div
      = position_rating_display(check_in.manager_rating)
    .finalization-notes-cell
      %small.text-muted= simple_format(check_in.manager_private_notes)
  %td
    - if view_mode == :employee
      %small.text-muted Waiting for manager to set
    - else
      = form.text_area "position_check_in[shared_notes]", class: "form-control form-control-sm", rows: 2, placeholder: "Shared summary and action items..."
  %td
    - if view_mode == :employee
      %small.text-muted Waiting for manager to set
    - else
      = form.select "position_check_in[official_rating]", position_rating_options, { selected: check_in.manager_rating || check_in.employee_rating, prompt: 'Select rating...' }, { class: "form-select form-select-sm", required: true }
  %td.text-center
    - if view_mode == :employee
      = form.check_box "position_check_in[finalize]", { class: "form-check-input", disabled: true, checked: true }, "1", "0"
      %br
      %small.text-muted (Manager only)
    - else
      = form.check_box "position_check_in[finalize]", { class: "form-check-input finalize-checkbox", checked: true, data: { alert: "This row will not be saved if this stays unchecked" } }, "1", "0"
