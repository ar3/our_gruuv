-# Assignment Job Description Partial
-# Usage: = render 'assignment_job_description', pa: pa, assignment_type: 'required' or 'suggested', organization: organization, public_view: false (optional)
-# If public_view is true, uses public MAAP paths; otherwise uses authenticated paths

- public_view = defined?(public_view) ? public_view : (params[:controller].to_s.include?('public_maap') rescue false)
- assignment_path = public_view ? organization_public_maap_assignment_path(organization, pa.assignment) : organization_assignment_path(organization, pa.assignment)

%h5.mb-0
  %strong= pa.assignment.title
  = link_to assignment_path, target: "_blank", class: "ms-2 text-muted" do
    %i.bi.bi-link-45deg

%p.mb-2
  %small.text-muted.fst-italic
    - if pa.min_estimated_energy.present? && pa.max_estimated_energy.present?
      (likely #{pa.min_estimated_energy}% to #{pa.max_estimated_energy}% of your energy)
    - elsif pa.max_estimated_energy.present?
      (up to #{pa.max_estimated_energy}% of your energy)
    - elsif pa.min_estimated_energy.present?
      (at least #{pa.min_estimated_energy}% of your energy)
    - else
      (at least 5% of your energy)

.assignment-details.ms-4.ps-3.border-start.border-2{class: assignment_type == 'required' ? 'border-primary' : 'border-info'}
  - if pa.assignment.tagline.present?
    %p.mb-2= pa.assignment.tagline
  
  %p.mb-1.text-muted
    %span='… as measured by –'
    - if pa.assignment.outcomes.any?
      %ul.mt-0
        - pa.assignment.outcomes.each do |outcome|
          %li.text-muted
            = outcome.description
    - else
      %span.text-muted outcomes to be determined
  
  %p.mb-2.text-muted
    = render 'shared/abilities_sentence', 
             assignment_abilities: pa.assignment.assignment_abilities.by_milestone_level,
             public_view: public_view,
             show_milestone_parentheticals: false,
             include_prefix: true
