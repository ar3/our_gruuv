- content_for :title, "Customize View"

- content_for :header do
  Customize Culture of Feedback and Recognition View
- content_for :return_url do
  = @return_url || organization_observations_path(@organization)
- content_for :return_text do
  = @return_text || 'Back to Culture of Feedback and Recognition'

= form_with url: update_view_organization_observations_path(@organization), method: :patch, local: true, data: { controller: "timeframe" } do |form|
  .row
    .col-md-4
      .mb-4
        %h2 Choose Preset
    .col-md-8
      / Preset Section - Grid of Buttons
      .card.mb-4
        .card-body
          %label.form-label.fw-bold.mb-3 Choose Preset
          - presets = available_observation_presets_with_permissions(@organization, current_company_teammate)
          .row.g-3
            - presets.each do |preset|
              .col-md-4.col-sm-6
                - if preset[:available]
                  %button.btn.btn-outline-primary.w-100.h-100.d-flex.flex-column.align-items-center.justify-content-center.p-3{type: 'submit', name: 'preset', value: preset[:value], style: 'min-height: 100px;'}
                    %i.bi.bi-check-circle.mb-2{style: "font-size: 1.5rem;"}
                    %span.fw-bold.text-center= preset[:name]
                - else
                  .d-flex.align-items-center.gap-2.w-100
                    .flex-grow-1
                      %button.btn.btn-outline-secondary.w-100.h-100.d-flex.flex-column.align-items-center.justify-content-center.p-3.disabled{type: 'button', disabled: true, style: 'min-height: 100px; opacity: 0.6; cursor: not-allowed;'}
                        %i.bi.bi-lock.mb-2{style: "font-size: 1.5rem;"}
                        %span.fw-bold.text-center= preset[:name]
                    %i.bi.bi-exclamation-triangle.text-warning{data: {bs_toggle: "tooltip", bs_title: preset[:tooltip]}, style: "font-size: 1.2rem;"}
  .row
    .col-12.text-center
      %hr/
      %h1.text-muted --OR--
      %small.text-muted Customize Your View
      %hr/
  .row
    .col-md-4
      .mb-4
        %h2 Select What Observations You See
    
    .col-md-8
      / Filters Section
      .card.mb-4
        .card-body
          %label.form-label.fw-bold Select What Observations You See
          
          .mb-3
            %label.form-label Privacy Level
            .form-check
              = check_box_tag 'privacy[]', 'observer_only', @current_filters[:privacy]&.include?('observer_only'), class: 'form-check-input', id: 'privacy_observer_only'
              = label_tag 'privacy_observer_only', 'ðŸ”’ Journal Entries', class: 'form-check-label'
            .form-check
              = check_box_tag 'privacy[]', 'observed_only', @current_filters[:privacy]&.include?('observed_only'), class: 'form-check-input', id: 'privacy_observed_only'
              = label_tag 'privacy_observed_only', 'ðŸ‘¤ 1-on-1 Feedback', class: 'form-check-label'
            .form-check
              = check_box_tag 'privacy[]', 'managers_only', @current_filters[:privacy]&.include?('managers_only'), class: 'form-check-input', id: 'privacy_managers_only'
              = label_tag 'privacy_managers_only', 'ðŸ‘” Managers Only', class: 'form-check-label'
            .form-check
              = check_box_tag 'privacy[]', 'observed_and_managers', @current_filters[:privacy]&.include?('observed_and_managers'), class: 'form-check-input', id: 'privacy_observed_and_managers'
              = label_tag 'privacy_observed_and_managers', 'ðŸ‘¥ Full Transparency', class: 'form-check-label'
            .form-check
              = check_box_tag 'privacy[]', 'public_to_company', @current_filters[:privacy]&.include?('public_to_company'), class: 'form-check-input', id: 'privacy_public_to_company'
              = label_tag 'privacy_public_to_company', 'ðŸ¢ Public to Company', class: 'form-check-label'
            .form-check
              = check_box_tag 'privacy[]', 'public_to_world', @current_filters[:privacy]&.include?('public_to_world'), class: 'form-check-input', id: 'privacy_public_to_world'
              = label_tag 'privacy_public_to_world', 'ðŸŒ Public to World', class: 'form-check-label'
          
          .mb-3
            %label.form-label Timeframe
            .form-check
              = radio_button_tag 'timeframe', 'this_week', @current_filters[:timeframe] == 'this_week', class: 'form-check-input', id: 'timeframe_this_week'
              = label_tag 'timeframe_this_week', 'This Week', class: 'form-check-label'
            .form-check
              = radio_button_tag 'timeframe', 'this_month', @current_filters[:timeframe] == 'this_month', class: 'form-check-input', id: 'timeframe_this_month'
              = label_tag 'timeframe_this_month', 'This Month', class: 'form-check-label'
            .form-check
              = radio_button_tag 'timeframe', 'this_quarter', @current_filters[:timeframe] == 'this_quarter', class: 'form-check-input', id: 'timeframe_this_quarter'
              = label_tag 'timeframe_this_quarter', 'This Quarter', class: 'form-check-label'
            .form-check
              = radio_button_tag 'timeframe', 'last_45_days', @current_filters[:timeframe] == 'last_45_days', class: 'form-check-input', id: 'timeframe_last_45_days'
              = label_tag 'timeframe_last_45_days', 'Last 45 Days', class: 'form-check-label'
            .form-check
              = radio_button_tag 'timeframe', 'last_90_days', @current_filters[:timeframe] == 'last_90_days', class: 'form-check-input', id: 'timeframe_last_90_days'
              = label_tag 'timeframe_last_90_days', 'Last 90 Days', class: 'form-check-label'
            .form-check
              = radio_button_tag 'timeframe', 'this_year', @current_filters[:timeframe] == 'this_year', class: 'form-check-input', id: 'timeframe_this_year'
              = label_tag 'timeframe_this_year', 'This Year', class: 'form-check-label'
            .form-check
              = radio_button_tag 'timeframe', 'between', @current_filters[:timeframe] == 'between', class: 'form-check-input', id: 'timeframe_between', data: { action: 'change->timeframe#toggleBetweenFields' }
              = label_tag 'timeframe_between', 'Between', class: 'form-check-label'
            .between-fields-container.mt-2.mb-2.ms-4{style: "display: #{@current_filters[:timeframe] == 'between' ? 'block' : 'none'};"}
              .row
                .col-md-6
                  = label_tag 'timeframe_start_date', 'Start Date', class: 'form-label'
                  = date_field_tag 'timeframe_start_date', @current_filters[:timeframe_start_date], class: 'form-control', id: 'timeframe_start_date'
                .col-md-6
                  = label_tag 'timeframe_end_date', 'End Date', class: 'form-label'
                  = date_field_tag 'timeframe_end_date', @current_filters[:timeframe_end_date], class: 'form-control', id: 'timeframe_end_date'
            .form-check
              = radio_button_tag 'timeframe', 'all', @current_filters[:timeframe].blank? || @current_filters[:timeframe] == 'all', class: 'form-check-input', id: 'timeframe_all'
              = label_tag 'timeframe_all', 'All Time', class: 'form-check-label'

  .row
    .col-md-4
      .mb-4
        %h2 Select What Order You See Them In
    
    .col-md-8
      / Sort Section
      .card.mb-4
        .card-body
          %label.form-label.fw-bold Select What Order You See Them In
          .mb-3
            %label.form-label Sort By
            = select_tag 'sort', options_for_select(observation_sort_options, @current_sort), class: 'form-select', id: 'sort_select'

  .row
    .col-md-4
      .mb-4
        %h2 Select How They Appear
    
    .col-md-8
      / View Style Section
      .card.mb-4
        .card-body
          %label.form-label.fw-bold Select How They Appear
          .form-check
            = radio_button_tag 'view', 'table', @current_view == 'table', class: 'form-check-input', id: 'view_table'
            = label_tag 'view_table', class: 'form-check-label' do
              %i.bi.bi-table.me-2
              Table View
          .form-check
            = radio_button_tag 'view', 'cards', @current_view == 'cards', class: 'form-check-input', id: 'view_cards'
            = label_tag 'view_cards', class: 'form-check-label' do
              %i.bi.bi-grid.me-2
              Card View
          .form-check
            = radio_button_tag 'view', 'list', @current_view == 'list', class: 'form-check-input', id: 'view_list'
            = label_tag 'view_list', class: 'form-check-label' do
              %i.bi.bi-list.me-2
              List View
          .form-check
            = radio_button_tag 'view', 'large_list', @current_view == 'large_list', class: 'form-check-input', id: 'view_large_list'
            = label_tag 'view_large_list', class: 'form-check-label' do
              %i.bi.bi-list-ul.me-2
              Large List View
          .form-check
            = radio_button_tag 'view', 'wall', @current_view == 'wall', class: 'form-check-input', id: 'view_wall'
            = label_tag 'view_wall', class: 'form-check-label' do
              %i.bi.bi-images.me-2
              Social Wall View

  .row
    .col-md-4
      .mb-4
        %h2 Select the Spotlight for Them
    
    .col-md-8
      / Spotlight Section
      .card.mb-4
        .card-body
          %label.form-label.fw-bold Select the Spotlight for Them
          .form-check
            = radio_button_tag 'spotlight', 'overview', (@current_spotlight.blank? || @current_spotlight == 'overview'), class: 'form-check-input', id: 'spotlight_overview'
            = label_tag 'spotlight_overview', 'Overview', class: 'form-check-label'
          .form-check
            = radio_button_tag 'spotlight', 'my_journal', @current_spotlight == 'my_journal', class: 'form-check-input', id: 'spotlight_my_journal'
            = label_tag 'spotlight_my_journal', 'My Journal', class: 'form-check-label'
          .form-check
            = radio_button_tag 'spotlight', 'team_wins', @current_spotlight == 'team_wins', class: 'form-check-input', id: 'spotlight_team_wins'
            = label_tag 'spotlight_team_wins', 'Team Wins', class: 'form-check-label'
          .form-check
            = radio_button_tag 'spotlight', 'this_week', @current_spotlight == 'this_week', class: 'form-check-input', id: 'spotlight_this_week'
            = label_tag 'spotlight_this_week', 'This Week', class: 'form-check-label'
          .form-check
            = radio_button_tag 'spotlight', 'feedback_health', @current_spotlight == 'feedback_health', class: 'form-check-input', id: 'spotlight_feedback_health'
            = label_tag 'spotlight_feedback_health', 'Feedback Health', class: 'form-check-label'
          .form-check
            = radio_button_tag 'spotlight', 'most_observed', @current_spotlight == 'most_observed', class: 'form-check-input', id: 'spotlight_most_observed'
            = label_tag 'spotlight_most_observed', 'Most Observed', class: 'form-check-label'
          .form-check
            = radio_button_tag 'spotlight', 'none', @current_spotlight == 'none', class: 'form-check-input', id: 'spotlight_none'
            = label_tag 'spotlight_none', 'No Spotlight', class: 'form-check-label'

  .row
    .col-12
      / Form Actions
      .d-flex.gap-2.mt-4.mb-4
        = form.submit 'Apply View', class: 'btn btn-primary'
        = link_to 'Cancel', @return_url || organization_observations_path(@organization), class: 'btn btn-outline-secondary'

