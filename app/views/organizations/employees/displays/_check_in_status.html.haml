/ Check-in Status Card Display
.row.justify-content-center
  .col-lg-12
    / Legend
    .row.mb-3
      .col-12
        .alert.alert-light.py-2
          %small.text-muted
            %strong Legend:
            %span.badge.bg-success.ms-2 Fresh (&lt; 90 days)
            %span.badge.bg-info.ms-2 Stale/Active (&gt; 90 days, in progress)
            %span.badge.bg-warning.ms-2 Stale/Inactive (&gt; 90 days, no activity)
    
    - if @teammates.any?
      .row
        - @teammates.each do |teammate|
          .col-lg-12.mb-4
            .card.border-0.shadow-sm
              .card-body
                .row.align-items-start
                  / Column 1: Employee Info (25%)
                  .col-md-3
                    .d-flex.flex-column
                      %h5.mb-2
                        = link_to teammate.person.display_name, person_path(teammate.person), class: "text-decoration-none"
                      = overall_status_badge(overall_employee_status(teammate.person, @organization))
                      %small.text-muted.mt-1
                        = teammate_current_position(teammate)
                  
                  / Column 2: Check-ins (25%)
                  .col-md-3
                    %h6.text-muted.mb-2 Check-ins
                    - check_ins = check_ins_for_employee(teammate.person, @organization)
                    
                    / Position check-ins summary
                    .mb-3
                      .d-flex.justify-content-between.align-items-center.mb-1
                        %strong.small Position
                        - if check_ins[:position].any?
                          %span.badge.bg-secondary= check_ins[:position].count
                      - position_summary = check_in_freshness_summary(check_ins[:position])
                      = render_freshness_progress_bar(position_summary)
                    
                    / Assignment check-ins summary
                    .mb-3
                      .d-flex.justify-content-between.align-items-center.mb-1
                        %strong.small Assignments
                        - if check_ins[:assignments].any?
                          %span.badge.bg-secondary= check_ins[:assignments].count
                      - assignment_summary = check_in_freshness_summary(check_ins[:assignments])
                      = render_freshness_progress_bar(assignment_summary)
                    
                    / Aspiration check-ins summary
                    .mb-3
                      .d-flex.justify-content-between.align-items-center.mb-1
                        %strong.small Aspirations
                        - if check_ins[:aspirations].any?
                          %span.badge.bg-secondary= check_ins[:aspirations].count
                      - aspiration_summary = check_in_freshness_summary(check_ins[:aspirations])
                      = render_freshness_progress_bar(aspiration_summary)
                  
                  / Column 3: Ready for Finalization (25%)
                  .col-md-3
                    %h6.text-muted.mb-2 Ready for Finalization
                    - finalization_summary = finalization_summary_by_type(check_ins)
                    
                    - if finalization_summary[:total] > 0
                      .mb-2
                        - if finalization_summary[:position] > 0
                          .d-flex.justify-content-between.align-items-center.mb-1
                            %strong.small Position
                            %span.badge.bg-warning= finalization_summary[:position]
                        - if finalization_summary[:assignments] > 0
                          .d-flex.justify-content-between.align-items-center.mb-1
                            %strong.small Assignments
                            %span.badge.bg-warning= finalization_summary[:assignments]
                        - if finalization_summary[:aspirations] > 0
                          .d-flex.justify-content-between.align-items-center.mb-1
                            %strong.small Aspirations
                            %span.badge.bg-warning= finalization_summary[:aspirations]
                      = link_to "Finalize (#{finalization_summary[:total]})", organization_person_check_ins_path(@organization, teammate.person), class: "btn btn-sm btn-outline-warning"
                    - else
                      %small.text-muted None ready
                  
                  / Column 4: Pending Acknowledgements (25%)
                  .col-md-3
                    %h6.text-muted.mb-2 Pending Acknowledgements
                    - ack_summary = acknowledgement_summary_by_type(teammate.person, @organization)
                    
                    - if ack_summary[:total] > 0
                      .mb-2
                        - if ack_summary[:position] > 0
                          .d-flex.justify-content-between.align-items-center.mb-1
                            %strong.small Position
                            %span.badge.bg-danger= ack_summary[:position]
                        - if ack_summary[:assignments] > 0
                          .d-flex.justify-content-between.align-items-center.mb-1
                            %strong.small Assignments
                            %span.badge.bg-danger= ack_summary[:assignments]
                        - if ack_summary[:aspirations] > 0
                          .d-flex.justify-content-between.align-items-center.mb-1
                            %strong.small Aspirations
                            %span.badge.bg-danger= ack_summary[:aspirations]
                        - if ack_summary[:milestones] > 0
                          .d-flex.justify-content-between.align-items-center.mb-1
                            %strong.small Milestones
                            %span.badge.bg-danger= ack_summary[:milestones]
                        - if ack_summary[:bulk] > 0
                          .d-flex.justify-content-between.align-items-center.mb-1
                            %strong.small Bulk Updates
                            %span.badge.bg-danger= ack_summary[:bulk]
                      = link_to "View Audit (#{ack_summary[:total]})", audit_organization_employee_path(@organization, teammate.person), class: "btn btn-sm btn-outline-danger"
                    - else
                      %small.text-muted None pending
    - else
      .alert.alert-info
        %h6.mb-2
          %i.bi.bi-info-circle.me-2
          No Direct Reports Found
        %p.mb-2 
          You don't have any direct reports in this organization.
          = link_to "View All Teammates", organization_employees_path(@organization), class: "btn btn-primary btn-sm"
