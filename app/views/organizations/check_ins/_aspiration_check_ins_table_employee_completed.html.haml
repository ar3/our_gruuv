-# Aspiration Check-In Table View - Employee Completed State
.table-responsive
  %table.table.table-striped
    %thead
      %tr
        %th Aspiration
        %th Employee Rating
        %th Employee Notes
        %th Manager Status
        %th Actions
    %tbody
      - check_ins.each do |check_in|
        - if check_in.employee_completed?
          %tr
            %td= check_in.aspiration.name
            %td
              = aspiration_rating_display(check_in.employee_rating)
            %td
              = simple_format(check_in.employee_private_notes)
            %td
              - if check_in.manager_completed?
                .badge.bg-success Ready for Finalization
                %br
                %small.text-muted #{check_in.manager_completed_by&.first_name || 'Your manager'} has completed their assessment
              - else
                .badge.bg-warning Waiting for Manager
                %br
                %small.text-muted #{check_in.manager_completed_by&.first_name || 'Your manager'} has not completed their assessment
            %td
              - if check_in.manager_completed?
                = link_to "Go to Finalization", organization_person_finalization_path(@organization, @person), 
                          class: 'btn btn-success btn-sm',
                          data: { confirm: 'Your manager will review both assessments and set the official rating.' }

.form-group.mt-3
  %label Status
  - check_ins.each do |check_in|
    - if check_in.employee_completed?
      = form.fields_for :aspiration_check_ins, check_in, index: check_in.id do |af|
        .form-check
          = af.radio_button :status, 'complete', checked: true
          = af.label :status_complete, 'Ready for Manager', class: 'form-check-label'
        .form-check
          = af.radio_button :status, 'draft'
          = af.label :status_draft, 'Make Changes', class: 'form-check-label'
      
      .small.text-muted.mt-1
        Select "Make Changes" to edit your assessment and notes
