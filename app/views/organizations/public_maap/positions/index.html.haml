- content_for :title, "Public MAAP - Positions"

.mb-3
  = link_to organization_public_maap_path(@organization), class: "text-muted text-decoration-none" do
    %i.bi.bi-arrow-left.me-2
    Back to #{@organization.name} Public MAAP

%h1.mb-4 Public Positions

- if current_person
  .mb-3
    = link_to organization_positions_path(@organization), class: "text-muted text-decoration-none" do
      %i.bi.bi-lock.me-2
      View Authenticated Version

- if @positions.any?
  - company = @organization.root_company || @organization
  - hierarchy = build_organization_hierarchy(company)
  
  .card.mb-4
    .card-header
      %h5.mb-0 Positions by Organization
    .card-body
      / Show company-level positions (key is nil when grouped by title.department)
      - company_positions = @positions_by_org[nil] || []
      - if company_positions.any?
        %h6.mb-3= company.name
        %ul.list-unstyled.ms-3
          - company_positions.each do |position|
            %li.mb-2
              = link_to position.display_name, organization_public_maap_position_path(@organization, position), class: "text-decoration-none"
      
      / Show department-level positions with indentation
      - hierarchy.each do |item|
        = render 'organization_hierarchy_item', item: item, positions_by_org: @positions_by_org, organization: @organization
- else
  .alert.alert-info
    %h6.mb-2
      %i.bi.bi-info-circle.me-2
      No Public Positions Available
    %p.mb-0
      There are currently no public positions available for this organization.

