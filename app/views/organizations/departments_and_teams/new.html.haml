- content_for :go_back_link do
  = link_to organization_departments_and_teams_path(@organization), class: "go-back-link" do
    %i.bi.bi-arrow-left.me-2
    Back to Departments & Teams

- content_for :header do
  %h1.mb-0
    %i.bi.bi-plus-circle.me-2
    New Department or Team

.row.justify-content-center
  .col-lg-8
    .card
      .card-body
        - if @department_or_team.parent.present?
          .alert.alert-info.mb-3
            %i.bi.bi-info-circle.me-2
            Creating a child organization under 
            %strong= @department_or_team.parent.display_name
        
        = form_with model: @department_or_team, url: organization_departments_and_teams_path(@organization), local: true, scope: :organization do |form|
          - if @department_or_team.errors.any?
            .alert.alert-danger
              %h5= "#{pluralize(@department_or_team.errors.count, "error")} prohibited this organization from being saved:"
              %ul.mb-0
                - @department_or_team.errors.full_messages.each do |message|
                  %li= message
          
          .mb-3
            = form.label :name, class: "form-label"
            = form.text_field :name, class: "form-control", required: true
          
          .mb-3
            = form.label :type, "Organization Type", class: "form-label"
            = form.select :type, options_for_select([['Department', 'Department'], ['Team', 'Team']], @department_or_team.type), { prompt: 'Select organization type' }, { class: "form-select", required: true }
          
          .mb-3
            = form.label :parent_id, "Parent Organization", class: "form-label"
            = form.hidden_field :parent_id, value: @department_or_team.parent_id || @organization.id
            - parent_org = @department_or_team.parent || @organization
            .form-control-plaintext= parent_org.display_name
            %small.form-text.text-muted The parent organization cannot be changed after creation.
          
          .d-flex.justify-content-between
            = link_to "Cancel", organization_departments_and_teams_path(@organization), class: "btn btn-secondary"
            = form.submit "Create Department or Team", class: "btn btn-primary"

