- content_for :title, "Bank Awards"

- content_for :header do
  .d-flex.align-items-center.justify-content-between
    %h1.mb-0.me-2
      %i.bi.bi-bank.me-2
      Bank Awards
    .d-flex.align-items-center
      - if policy(:kudos).award_bank_points?
        = link_to new_organization_kudos_rewards_bank_award_path(@organization), class: "btn btn-primary" do
          %i.bi.bi-plus-circle.me-1
          Award Points
      - else
        .btn.btn-primary.disabled{style: "opacity: 0.6; cursor: not-allowed;"}
          %i.bi.bi-plus-circle.me-1
          Award Points
        %i.bi.bi-exclamation-triangle.text-warning.ms-2{"data-bs-toggle" => "tooltip", "data-bs-title" => "You need kudos points management permission to award points"}

- content_for :go_back_link do
  = link_to kudos_points_organization_company_teammate_path(@organization, current_company_teammate), class: "go-back-link" do
    %i.bi.bi-arrow-left.me-2
    Back to #{company_label_plural('kudos_point', 'Kudos Point')}

/ Spotlight: total points in people's ledgers
.card.border-0.shadow-sm.mb-4
  .card-body
    .row.text-center
      .col-md-6
        .h4.text-primary= kudos_points_display(@total_points_to_give.to_f)
        %small.text-muted Total #{company_label_plural('kudos_point', 'Kudos Point')} to Give (in people's ledgers)
      .col-md-6
        .h4.text-success= kudos_points_display(@total_points_to_redeem.to_f)
        %small.text-muted Total #{company_label_plural('kudos_point', 'Kudos Point')} to Redeem (in people's ledgers)

.card
  .card-header
    %h5.mb-0
      %i.bi.bi-clock-history.me-2
      Recent Bank Awards

  .card-body
    - if @recent_awards.any?
      .table-responsive
        %table.table.table-hover.mb-0
          %thead
            %tr
              %th Date
              %th Recipient
              %th Awarded By
              %th To Give
              %th To Spend
              %th Reason
          %tbody
            - @recent_awards.each do |award|
              %tr
                %td
                  = award.created_at.strftime("%b %d, %Y")
                  %br
                  %small.text-muted= award.created_at.strftime("%I:%M %p")
                %td= award.recipient_name
                %td= award.banker_name
                %td.text-success
                  - if award.points_to_give_delta.to_f > 0
                    = "+#{award.points_to_give_delta}"
                  - else
                    \-
                %td.text-success
                  - if award.points_to_spend_delta.to_f > 0
                    = "+#{award.points_to_spend_delta}"
                  - else
                    \-
                %td
                  %span{ title: award.reason }
                    = truncate(award.reason, length: 40)
    - else
      .text-center.py-4
        %i.bi.bi-inbox.fs-1.text-muted
        %p.text-muted.mt-2 No bank awards yet.
        %p.small.text-muted
          = link_to "Award your first points", new_organization_kudos_rewards_bank_award_path(@organization)
