.container.mt-4
  .row.justify-content-center
    .col-lg-8
      .card
        .card-header.bg-primary.text-white
          %h3.mb-0
            %i.bi.bi-person-circle.me-2
            My Profile
        
        .card-body
          .row
            .col-md-6
              %h5.text-primary Personal Information
              %p
                %strong Name:
                = @person.full_name
              %p
                %strong Email:
                = @person.email
              - if @person.unique_textable_phone_number.present?
                %p
                  %strong Phone:
                  = @person.unique_textable_phone_number
              %p
                %strong Timezone:
                = @person.timezone.present? ? @person.timezone : 'Not set (using Eastern Time)'
            
            .col-md-6
              %h5.text-primary Account Statistics
              %p
                %strong Huddles Participated:
                = @person.huddles.count
              %p
                %strong Feedback Submitted:
                = @person.huddle_feedbacks.count
              %p
                %strong Member Since:
                = @person.created_at.strftime('%B %d, %Y')
          
          .mt-4
            = link_to edit_profile_path, class: "btn btn-primary" do
              %i.bi.bi-pencil.me-2
              Edit Profile

        / Identity Management Section
        .card.mt-4
          .card-header.bg-info.text-white
            %h5.mb-0
              %i.bi.bi-shield-lock.me-2
              Connected Accounts
        
          .card-body
            - if @person.person_identities.any?
              .table-responsive
                %table.table.table-hover
                  %thead
                    %tr
                      %th Account Type
                      %th Name
                      %th Email
                      %th Status
                      %th Connected
                      %th Actions
                  %tbody
                    - @person.person_identities.each do |identity|
                      %tr
                        %td
                          = identity_profile_image(identity, size: 24)
                          %i{class: "bi #{identity_provider_icon(identity)} me-2"}
                          = identity_provider_name(identity)
                        %td
                          - if identity.name.present?
                            = identity.name
                          - else
                            %span.text-muted Not provided
                        %td= identity.email
                        %td= identity_status_badge(identity)
                        %td= identity.created_at.strftime('%B %d, %Y')
                        %td
                          = disconnect_identity_button(identity)
                      %tr
                        %td{colspan: 6}
                          = identity_raw_data_display(identity)
            - else
              %p.text-muted No connected accounts found.
            
            -# .mt-3
            -#   = connect_google_button 

        / Employment Tenures Section
        .card.mt-4
          .card-header.bg-success.text-white
            %h5.mb-0
              %i.bi.bi-briefcase.me-2
              Employment History
        
          .card-body
            - if @employment_tenures.any?
              .table-responsive
                %table.table.table-hover
                  %thead
                    %tr
                      %th Company
                      %th Position
                      %th Manager
                      %th Duration
                      %th Status
                      %th Actions
                  %tbody
                    - @employment_tenures.each do |tenure|
                      %tr
                        %td= tenure.company.display_name
                        %td= tenure.position.display_name
                        %td= tenure.manager_display
                        %td= tenure.duration_display
                        %td= tenure.status_badge
                        %td
                          .btn-group.btn-group-sm
                            = link_to 'View', tenure, class: 'btn btn-outline-primary btn-sm'
                            = link_to 'Edit', edit_employment_tenure_path(tenure), class: 'btn btn-outline-secondary btn-sm'
              .mt-3
                = link_to new_employment_tenure_path, class: 'btn btn-success' do
                  %i.bi.bi-plus.me-2
                  Add Employment Tenure
            - else
              %p.text-muted No employment history found.
              .mt-3
                = link_to new_employment_tenure_path, class: 'btn btn-success' do
                  %i.bi.bi-plus.me-2
                  Add Your First Employment Tenure 